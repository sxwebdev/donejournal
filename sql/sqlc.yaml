version: "2"
overrides:
  go:
    overrides:
      - db_type: jsonb
        go_type:
          type: JSONField
          import: github.com/sxwebdev/donejournal/internal/store/storecmn

      - db_type: JSONB
        go_type:
          type: JSONField
          import: github.com/sxwebdev/donejournal/internal/store/storecmn

      # inbox
      - column: inbox.id
        go_struct_tag: validate:"required"
      - column: inbox.data
        go_struct_tag: validate:"required"
      - column: inbox.user_id
        go_struct_tag: validate:"required"

      # todos
      - column: todos.id
        go_struct_tag: validate:"required"
      - column: todos.title
        go_struct_tag: validate:"required"
      - column: todos.status
        go_struct_tag: validate:"required,oneof=pending inprogress completed cancelled"
        go_type:
          type: TodoStatusType
      - column: todos.user_id
        go_struct_tag: validate:"required"

sql:
  # inbox
  - schema: migrations
    queries: queries/inbox
    engine: sqlite
    gen:
      go:
        out: ../internal/store/repos/repo_inbox
        emit_prepared_queries: false
        emit_json_tags: true
        emit_exported_queries: false
        emit_db_tags: true
        emit_interface: true
        emit_exact_table_names: false
        emit_empty_slices: true
        emit_result_struct_pointers: true
        emit_params_struct_pointers: false
        emit_enum_valid_method: true
        emit_all_enum_values: true
        query_parameter_limit: 2

  # todos
  - schema: migrations
    queries: queries/todos
    engine: sqlite
    gen:
      go:
        out: ../internal/store/repos/repo_todos
        emit_prepared_queries: false
        emit_json_tags: true
        emit_exported_queries: false
        emit_db_tags: true
        emit_interface: true
        emit_exact_table_names: false
        emit_empty_slices: true
        emit_result_struct_pointers: true
        emit_params_struct_pointers: false
        emit_enum_valid_method: true
        emit_all_enum_values: true
        query_parameter_limit: 2
